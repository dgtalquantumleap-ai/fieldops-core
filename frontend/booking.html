<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Book professional cleaning services with Stilt Heights. Easy online booking, competitive prices, and exceptional service in Calgary, AB.">
    <title>Book a Cleaning â€” Stilt Heights</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ </text></svg>">
    <meta property="og:title" content="Book a Cleaning â€” Stilt Heights">
    <meta property="og:description" content="Professional cleaning services for your home or office. Book online in minutes!">

    <style>
        :root {
            --blue:       #2563eb;
            --blue-dark:  #1e40af;
            --blue-light: #3b82f6;
            --blue-ring:  rgba(37, 99, 235, 0.15);
            --blue-shadow:rgba(37, 99, 235, 0.3);
            --green:      #059669;
            --green-bg:   #d1fae5;
            --amber:      #d97706;
            --amber-bg:   #fef3c7;
            --gray:       #6b7280;
            --gray-bg:    #f3f4f6;
            --red:        #dc2626;
            --red-bg:     #fef2f2;
            --text:       #1e293b;
            --muted:      #64748b;
            --border:     #e5e7eb;
            --radius:     12px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(150deg, var(--blue) 0%, var(--blue-dark) 100%);
            min-height: 100vh;
            color: var(--text);
            line-height: 1.6;
            padding: 24px 16px 40px;
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to   { opacity: 1; transform: translateY(0); }
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* â”€â”€ WRAPPER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .wrap {
            max-width: 780px;
            margin: 0 auto;
            animation: fadeInUp 0.5s ease-out;
        }

        /* â”€â”€ SITE HEADER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .site-header {
            text-align: center;
            margin-bottom: 16px;
            color: white;
        }
        .site-logo {
            font-size: 2rem;
            font-weight: 800;
            letter-spacing: -0.5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .site-logo span { font-size: 2.2rem; }
        .site-tagline {
            font-size: 0.95rem;
            opacity: 0.88;
            margin-top: 4px;
        }
        .site-phone {
            display: inline-block;
            margin-top: 8px;
            color: white;
            font-weight: 600;
            font-size: 1rem;
            text-decoration: none;
            background: rgba(255,255,255,0.18);
            padding: 6px 18px;
            border-radius: 99px;
            transition: background 0.2s;
        }
        .site-phone:hover { background: rgba(255,255,255,0.28); }

        /* â”€â”€ TRUST BADGES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .trust-strip {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px 24px;
            background: rgba(255,255,255,0.14);
            border-radius: 99px;
            padding: 10px 20px;
            margin-bottom: 18px;
            color: white;
            font-size: 0.85rem;
            font-weight: 500;
        }
        .trust-strip span { white-space: nowrap; }

        /* â”€â”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .tabs {
            display: flex;
            background: rgba(255,255,255,0.15);
            border-radius: 12px;
            padding: 4px;
            margin-bottom: 0;
            gap: 4px;
        }
        .tab-btn {
            flex: 1;
            padding: 10px 16px;
            border: none;
            border-radius: 9px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            background: transparent;
            color: rgba(255,255,255,0.8);
        }
        .tab-btn.active {
            background: white;
            color: var(--blue);
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
        }
        .tab-btn:not(.active):hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        /* â”€â”€ MAIN CARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .card {
            background: white;
            border-radius: 0 0 var(--radius) var(--radius);
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
            overflow: hidden;
        }

        /* â”€â”€ TAB PANELS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .tab-panel { display: none; padding: 32px 36px; }
        .tab-panel.active { display: block; }

        @media (max-width: 560px) {
            .tab-panel { padding: 24px 20px; }
        }

        /* â”€â”€ SECTION HEADERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .section-title {
            font-size: 1.15rem;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .section-divider {
            border: none;
            border-top: 2px solid #f1f5f9;
            margin: 28px 0;
        }

        /* â”€â”€ SERVICE CARDS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 12px;
            margin-bottom: 8px;
        }
        .service-card {
            border: 2px solid var(--border);
            border-radius: var(--radius);
            padding: 18px 14px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            background: #fafafa;
            position: relative;
        }
        .service-card:hover {
            border-color: var(--blue-light);
            box-shadow: 0 4px 14px var(--blue-ring);
            transform: translateY(-2px);
        }
        .service-card.selected {
            border-color: var(--blue);
            background: linear-gradient(135deg, var(--blue), var(--blue-dark));
            color: white;
        }
        .service-card.selected .svc-price,
        .service-card.selected .svc-desc { color: rgba(255,255,255,0.88); }

        .svc-name {
            font-weight: 700;
            font-size: 0.95rem;
            margin-bottom: 6px;
        }
        .svc-price {
            font-size: 1.25rem;
            font-weight: 800;
            color: var(--blue);
            margin-bottom: 6px;
        }
        .svc-desc {
            font-size: 0.78rem;
            color: var(--muted);
            line-height: 1.4;
        }
        .svc-check {
            position: absolute;
            top: 8px;
            right: 10px;
            font-size: 1rem;
            display: none;
        }
        .service-card.selected .svc-check { display: block; }

        /* â”€â”€ SELECTED SERVICE PILL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .selected-service-pill {
            display: none;
            align-items: center;
            justify-content: space-between;
            background: #eff6ff;
            border: 1.5px solid var(--blue-light);
            border-radius: 8px;
            padding: 10px 14px;
            margin-bottom: 20px;
            font-size: 0.9rem;
        }
        .selected-service-pill.visible { display: flex; }
        .pill-label { color: var(--muted); font-size: 0.8rem; }
        .pill-name { font-weight: 700; color: var(--blue); }
        .pill-change {
            font-size: 0.8rem;
            color: var(--blue);
            cursor: pointer;
            font-weight: 600;
            border: none;
            background: none;
            text-decoration: underline;
        }

        /* â”€â”€ PROGRESS BAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .progress-wrap { margin-bottom: 24px; }
        .progress-label {
            font-size: 0.78rem;
            color: var(--muted);
            margin-bottom: 6px;
            display: flex;
            justify-content: space-between;
        }
        .progress-bar {
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--blue), var(--blue-light));
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 3px;
        }

        /* â”€â”€ FORM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 18px;
        }
        .form-grid .full { grid-column: 1 / -1; }

        @media (max-width: 560px) {
            .form-grid { grid-template-columns: 1fr; }
            .form-grid .full { grid-column: 1; }
        }

        .form-group label {
            display: block;
            font-weight: 600;
            font-size: 0.88rem;
            color: #374151;
            margin-bottom: 6px;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 11px 14px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 0.95rem;
            font-family: inherit;
            transition: border-color 0.2s, box-shadow 0.2s;
            background: white;
        }
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--blue);
            box-shadow: 0 0 0 3px var(--blue-ring);
        }
        .form-hint {
            font-size: 0.76rem;
            color: var(--muted);
            margin-top: 4px;
        }

        /* â”€â”€ MESSAGES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .msg {
            padding: 13px 16px;
            border-radius: 8px;
            margin-bottom: 18px;
            font-size: 0.9rem;
            font-weight: 500;
            display: none;
        }
        .msg.error  { background: var(--red-bg);   border: 1px solid #fecaca; color: var(--red); }
        .msg.success{ background: var(--green-bg);  border: 1px solid #a7f3d0; color: var(--green); }

        /* â”€â”€ SUBMIT BUTTON â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .btn-submit {
            width: 100%;
            background: linear-gradient(135deg, var(--blue), var(--blue-dark));
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 1.05rem;
            font-weight: 700;
            cursor: pointer;
            margin-top: 8px;
            transition: all 0.2s;
        }
        .btn-submit:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 6px 20px var(--blue-shadow);
        }
        .btn-submit:disabled { opacity: 0.65; cursor: not-allowed; }
        .spinner {
            display: inline-block;
            width: 14px;
            height: 14px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
            margin-right: 8px;
            vertical-align: middle;
        }

        /* â”€â”€ TRACK TAB â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .track-inner {
            max-width: 440px;
            margin: 0 auto;
            text-align: center;
        }
        .track-inner .section-title { justify-content: center; }
        .track-subtitle {
            color: var(--muted);
            font-size: 0.9rem;
            margin-bottom: 24px;
        }
        .input-row {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
        }
        .input-row input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-family: monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: border-color 0.2s;
        }
        .input-row input:focus {
            outline: none;
            border-color: var(--blue);
            box-shadow: 0 0 0 3px var(--blue-ring);
        }
        input::placeholder { text-transform: none; letter-spacing: 0; color: #9ca3af; font-family: inherit; }
        .btn-check {
            padding: 12px 20px;
            background: linear-gradient(135deg, var(--blue), var(--blue-dark));
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 700;
            cursor: pointer;
            white-space: nowrap;
            transition: opacity 0.2s;
        }
        .btn-check:disabled { opacity: 0.6; cursor: not-allowed; }
        .ref-hint { font-size: 0.8rem; color: var(--muted); text-align: left; margin-bottom: 16px; }

        /* â”€â”€ STATUS RESULT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .result-card {
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
            margin-top: 20px;
            text-align: left;
            display: none;
        }
        .result-header {
            padding: 12px 18px;
            font-weight: 700;
            font-size: 0.82rem;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        .result-body { padding: 18px; display: grid; gap: 10px; }
        .result-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
        }
        .result-row .rl { color: var(--muted); font-size: 0.88rem; font-weight: 500; }
        .result-row .rv { font-weight: 600; font-size: 0.9rem; text-align: right; }
        .rv.ref-val { font-size: 1.05rem; color: var(--blue); font-weight: 800; letter-spacing: 1px; }

        .badge-status {
            display: inline-block;
            padding: 3px 12px;
            border-radius: 99px;
            font-size: 0.78rem;
            font-weight: 700;
        }
        .st-scheduled   { background: #dbeafe; color: #1d4ed8; }
        .st-in-progress { background: var(--amber-bg); color: var(--amber); }
        .st-completed   { background: var(--green-bg); color: var(--green); }
        .st-cancelled   { background: var(--gray-bg); color: var(--gray); }

        .track-link {
            display: block;
            margin-top: 20px;
            color: var(--blue);
            font-size: 0.88rem;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
        }
        .track-link:hover { text-decoration: underline; }

        /* â”€â”€ CONTACT FOOTER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .contact-footer {
            background: rgba(255,255,255,0.12);
            border-radius: var(--radius);
            padding: 20px 24px;
            text-align: center;
            margin-top: 16px;
            color: rgba(255,255,255,0.9);
            font-size: 0.88rem;
        }
        .contact-footer a { color: white; font-weight: 600; text-decoration: none; }
        .contact-footer a:hover { text-decoration: underline; }
        .contact-footer .cf-row { margin: 4px 0; }

        /* â”€â”€ ACCESSIBILITY â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        *:focus-visible {
            outline: 2px solid var(--blue);
            outline-offset: 2px;
        }

        /* â”€â”€ CONFIRMATION SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
        .confirm-screen {
            padding: 40px 36px;
            text-align: center;
        }
        .confirm-icon { font-size: 3.5rem; margin-bottom: 12px; }
        .confirm-title { color: var(--green); font-size: 1.7rem; font-weight: 800; margin-bottom: 6px; }
        .confirm-sub { color: var(--muted); margin-bottom: 24px; }
        .confirm-details {
            background: #f0fdf4;
            border: 1px solid #a7f3d0;
            border-radius: var(--radius);
            padding: 18px 20px;
            text-align: left;
            margin-bottom: 20px;
        }
        .confirm-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 16px;
            padding: 8px 0;
            border-bottom: 1px solid #d1fae5;
            font-size: 0.9rem;
        }
        .confirm-row:last-child { border-bottom: none; }
        .confirm-row .cl { color: var(--muted); font-weight: 500; white-space: nowrap; }
        .confirm-row .cv { font-weight: 600; text-align: right; }
        .ref-big { font-size: 1.15rem; color: var(--green); font-weight: 800; letter-spacing: 1px; }
        .btn-cal {
            display: inline-block;
            background: linear-gradient(135deg, var(--blue), var(--blue-dark));
            color: white;
            padding: 12px 28px;
            border-radius: 8px;
            font-weight: 600;
            text-decoration: none;
            font-size: 0.95rem;
            margin-bottom: 12px;
        }
        .confirm-notes {
            color: var(--muted);
            font-size: 0.85rem;
            line-height: 1.7;
            margin-top: 12px;
        }
        .btn-another {
            margin-top: 16px;
            background: none;
            border: 2px solid var(--blue);
            color: var(--blue);
            padding: 9px 22px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-size: 0.9rem;
            display: inline-block;
        }

        @media (max-width: 560px) {
            .confirm-screen { padding: 28px 20px; }
            body { padding: 16px 12px 32px; }
            .service-grid { grid-template-columns: 1fr 1fr; }
        }
        @media (max-width: 380px) {
            .service-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
<div class="wrap">

    <!-- â”€â”€ SITE HEADER â”€â”€ -->
    <div class="site-header">
        <div class="site-logo"><span>ğŸ </span> Stilt Heights</div>
        <div class="site-tagline">Professional Cleaning Services â€” Calgary, AB</div>
        <a href="tel:825-994-6606" class="site-phone">ğŸ“ 825-994-6606</a>
    </div>

    <!-- â”€â”€ TRUST STRIP â”€â”€ -->
    <div class="trust-strip">
        <span>âœ“ Insured &amp; Bonded</span>
        <span>âœ“ Background Checked</span>
        <span>â­ 4.9/5 Rating</span>
        <span>âœ“ Satisfaction Guaranteed</span>
    </div>

    <!-- â”€â”€ TABS â”€â”€ -->
    <div class="tabs">
        <button class="tab-btn active" id="tab-btn-book" onclick="switchTab('book')">
            ğŸ“‹ Book a Service
        </button>
        <button class="tab-btn" id="tab-btn-track" onclick="switchTab('track')">
            ğŸ” Track My Booking
        </button>
    </div>

    <!-- â”€â”€ MAIN CARD â”€â”€ -->
    <div class="card" id="mainCard">

        <!-- â”€â”€ BOOK TAB â”€â”€ -->
        <div class="tab-panel active" id="tab-book">

            <!-- Services showcase -->
            <div id="services-section">
                <div class="section-title">ğŸ§¹ Our Services &amp; Pricing</div>
                <div class="service-grid" id="serviceCards" role="radiogroup" aria-label="Select a service">
                    <p style="grid-column:1/-1;color:var(--muted);text-align:center;">Loading servicesâ€¦</p>
                </div>
            </div>

            <hr class="section-divider">

            <!-- Booking form -->
            <div id="booking-form-section">
                <div class="section-title">ğŸ“ Your Details</div>

                <!-- Selected service pill -->
                <div class="selected-service-pill" id="servicePill">
                    <div>
                        <div class="pill-label">Selected service</div>
                        <div class="pill-name" id="pillName">â€”</div>
                    </div>
                    <button class="pill-change" onclick="scrollToServices()">Change</button>
                </div>

                <!-- Progress -->
                <div class="progress-wrap">
                    <div class="progress-label">
                        <span>Form completion</span>
                        <span id="progressPct">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"
                             role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>

                <!-- Error -->
                <div class="msg error" id="error-msg" role="alert"></div>

                <!-- Form -->
                <form id="bookingForm" novalidate>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="name">Full Name *</label>
                            <input type="text" id="name" name="name" required autocomplete="name" placeholder="Jane Smith">
                        </div>
                        <div class="form-group">
                            <label for="phone">Phone *</label>
                            <input type="tel" id="phone" name="phone" required autocomplete="tel" placeholder="825-994-0000">
                        </div>
                        <div class="form-group full">
                            <label for="email">Email <span style="font-weight:400;color:var(--muted)">(optional â€” for confirmation)</span></label>
                            <input type="email" id="email" name="email" autocomplete="email" placeholder="you@example.com">
                        </div>
                        <div class="form-group full">
                            <label for="address">Service Address *</label>
                            <textarea id="address" name="address" rows="2" required placeholder="123 Main St, Calgary, AB T2P 0A1"></textarea>
                            <div class="form-hint">Include unit/suite number if applicable</div>
                        </div>
                        <div class="form-group">
                            <label for="date">Preferred Date *</label>
                            <input type="date" id="date" name="date" required>
                            <div class="form-hint">We'll confirm availability</div>
                        </div>
                        <div class="form-group">
                            <label for="time">Arrival Window *</label>
                            <select id="time" name="time" required>
                                <option value="">Choose a time</option>
                                <option value="09:00">9:00 AM â€“ 11:00 AM</option>
                                <option value="11:00">11:00 AM â€“ 1:00 PM</option>
                                <option value="13:00">1:00 PM â€“ 3:00 PM</option>
                                <option value="15:00">3:00 PM â€“ 5:00 PM</option>
                            </select>
                        </div>
                        <div class="form-group full">
                            <label for="notes">Additional Notes <span style="font-weight:400;color:var(--muted)">(optional)</span></label>
                            <textarea id="notes" name="notes" rows="2" placeholder="Pets, access codes, special requestsâ€¦"></textarea>
                        </div>
                    </div>

                    <button type="submit" class="btn-submit" id="submitBtn">
                        <span id="btnText">Book Now â€” Free Quote</span>
                    </button>
                </form>
            </div>
        </div>

        <!-- â”€â”€ TRACK TAB â”€â”€ -->
        <div class="tab-panel" id="tab-track">
            <div class="track-inner">
                <div class="section-title">ğŸ” Track Your Booking</div>
                <p class="track-subtitle">Enter your reference number to see the current status of your appointment.</p>

                <div class="input-row">
                    <input type="text" id="refInput" placeholder="JOB-0001"
                           maxlength="12" autocomplete="off" aria-label="Booking reference number">
                    <button class="btn-check" id="lookupBtn" onclick="lookupStatus()">Check</button>
                </div>
                <p class="ref-hint">Your reference was on your booking confirmation email (e.g. JOB-0001)</p>

                <div class="msg error" id="trackErrorMsg" role="alert"></div>

                <div class="result-card" id="resultCard">
                    <div class="result-header" id="resultHeader"></div>
                    <div class="result-body" id="resultBody"></div>
                </div>

                <a class="track-link" onclick="switchTab('book')">â† Book a new appointment</a>
            </div>
        </div>

    </div><!-- /.card -->

    <!-- â”€â”€ CONTACT FOOTER â”€â”€ -->
    <div class="contact-footer">
        <div class="cf-row">ğŸ“ <a href="tel:825-994-6606">825-994-6606</a> &nbsp;Â·&nbsp;
             ğŸ“§ <a href="mailto:info@stiltheights.com">info@stiltheights.com</a></div>
        <div class="cf-row">ğŸ• Monâ€“Fri 9 AM â€“ 6 PM &nbsp;Â·&nbsp; ğŸ“ Calgary, AB &amp; surrounding area</div>
    </div>

</div><!-- /.wrap -->

<script>
    // â”€â”€ HELPERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function escapeHtml(t) {
        return String(t || '').replace(/[&<>"']/g, m =>
            ({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#039;' }[m]));
    }

    // â”€â”€ TABS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function switchTab(name) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
        document.getElementById('tab-btn-' + name).classList.add('active');
        document.getElementById('tab-' + name).classList.add('active');
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    // â”€â”€ SERVICES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    let selectedService = '';
    let selectedServicePrice = 0;

    async function loadServices() {
        try {
            const res  = await fetch('/api/booking/services');
            const json = await res.json();
            const svcs = json.data || json;
            const grid = document.getElementById('serviceCards');

            if (!svcs || !svcs.length) {
                grid.textContent = 'No services available. Please call 825-994-6606.';
                return;
            }

            grid.innerHTML = svcs.map(s => `
                <div class="service-card"
                     data-id="${s.id}"
                     data-name="${escapeHtml(s.name)}"
                     data-price="${s.price || 0}"
                     role="radio" aria-checked="false" tabindex="0">
                    <span class="svc-check">âœ“</span>
                    <div class="svc-name">${escapeHtml(s.name)}</div>
                    <div class="svc-price">${s.price ? '$' + s.price : 'Call for price'}</div>
                    <div class="svc-desc">${escapeHtml(s.description || '')}</div>
                </div>`).join('');

            grid.querySelectorAll('.service-card').forEach(card => {
                card.addEventListener('click', () => selectService(card));
                card.addEventListener('keydown', e => {
                    if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); selectService(card); }
                });
            });
        } catch (err) {
            document.getElementById('serviceCards').textContent =
                'Unable to load services. Please refresh or call us.';
        }
    }

    function selectService(card) {
        document.querySelectorAll('.service-card').forEach(c => {
            c.classList.remove('selected');
            c.setAttribute('aria-checked', 'false');
        });
        card.classList.add('selected');
        card.setAttribute('aria-checked', 'true');
        selectedService      = card.dataset.name;
        selectedServicePrice = parseFloat(card.dataset.price) || 0;
        // Update pill
        const pill = document.getElementById('servicePill');
        document.getElementById('pillName').textContent = selectedService;
        pill.classList.add('visible');
        // Scroll to form
        document.getElementById('booking-form-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
        updateProgress();
    }

    function scrollToServices() {
        document.getElementById('services-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // â”€â”€ PROGRESS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function updateProgress() {
        const fd   = new FormData(document.getElementById('bookingForm'));
        let done   = 0;
        if (selectedService)      done++;
        if (fd.get('name'))       done++;
        if (fd.get('phone'))      done++;
        if (fd.get('address'))    done++;
        if (fd.get('date'))       done++;
        if (fd.get('time'))       done++;
        const pct = Math.round((done / 6) * 100);
        const fill = document.getElementById('progressFill');
        fill.style.width = pct + '%';
        fill.setAttribute('aria-valuenow', pct);
        document.getElementById('progressPct').textContent = pct + '%';
    }

    // â”€â”€ FORM VALIDATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function validateForm(fd) {
        const errs = [];
        if (!selectedService)              errs.push('Please select a service above');
        if (!fd.get('name')?.trim())       errs.push('Full name is required');
        if (!fd.get('phone')?.trim())      errs.push('Phone number is required');
        if (!fd.get('address')?.trim())    errs.push('Service address is required');
        if (!fd.get('date'))               errs.push('Please choose a date');
        if (!fd.get('time'))               errs.push('Please choose an arrival window');
        const email = fd.get('email')?.trim();
        if (email && !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) errs.push('Invalid email format');
        return errs;
    }

    function showError(id, msg) {
        const el = document.getElementById(id);
        el.textContent = msg;
        el.style.display = 'block';
        el.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    // â”€â”€ BOOKING CONFIRMATION â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function showConfirmation(booking, data) {
        const ref  = 'JOB-' + String(booking.jobId).padStart(4, '0');
        const dtRaw = new Date(booking.jobDate + 'T' + booking.jobTime + ':00');
        const fDate = dtRaw.toLocaleDateString('en-US', { weekday:'long', year:'numeric', month:'long', day:'numeric' });
        const fTime = dtRaw.toLocaleTimeString('en-US', { hour:'numeric', minute:'2-digit', hour12:true });
        const staff = booking.assignedStaff?.name || 'Our Team';

        // ICS
        const pad = n => String(n).padStart(2, '0');
        const endDt = new Date(dtRaw.getTime() + 2 * 3600000);
        const fICS  = d => `${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}T${pad(d.getHours())}${pad(d.getMinutes())}00`;
        const ics   = [
            'BEGIN:VCALENDAR','VERSION:2.0','PRODID:-//Stilt Heights//EN','BEGIN:VEVENT',
            'UID:' + ref + '@stiltheights.com',
            'DTSTART:' + fICS(dtRaw), 'DTEND:' + fICS(endDt),
            'SUMMARY:' + escapeHtml(booking.service) + ' â€” Stilt Heights',
            'DESCRIPTION:Booking ref: ' + ref + '. Cleaner: ' + escapeHtml(staff) + '.',
            'LOCATION:' + escapeHtml(data.address),
            'END:VEVENT','END:VCALENDAR'
        ].join('\r\n');
        const icsUrl = URL.createObjectURL(new Blob([ics], { type:'text/calendar' }));

        document.getElementById('mainCard').innerHTML = `
            <div class="confirm-screen" style="animation:fadeInUp 0.5s ease-out">
                <div class="confirm-icon">ğŸ‰</div>
                <div class="confirm-title">Booking Confirmed!</div>
                <p class="confirm-sub">Your appointment has been scheduled. See you soon!</p>
                <div class="confirm-details">
                    <div class="confirm-row">
                        <span class="cl">Reference</span>
                        <span class="cv ref-big">${ref}</span>
                    </div>
                    <div class="confirm-row">
                        <span class="cl">Service</span>
                        <span class="cv">${escapeHtml(booking.service)}</span>
                    </div>
                    <div class="confirm-row">
                        <span class="cl">Date</span>
                        <span class="cv">${fDate}</span>
                    </div>
                    <div class="confirm-row">
                        <span class="cl">Arrival Window</span>
                        <span class="cv">${fTime}</span>
                    </div>
                    <div class="confirm-row">
                        <span class="cl">Cleaner</span>
                        <span class="cv">${escapeHtml(staff)}</span>
                    </div>
                    <div class="confirm-row">
                        <span class="cl">Address</span>
                        <span class="cv" style="max-width:60%">${escapeHtml(data.address)}</span>
                    </div>
                </div>
                <a href="${escapeHtml(icsUrl)}" download="stilt-heights-${ref}.ics" class="btn-cal">
                    ğŸ“… Add to Calendar
                </a>
                <p class="confirm-notes">
                    We'll call to confirm at <strong>${escapeHtml(data.phone)}</strong>
                    ${data.email ? '<br>Confirmation email sent to <strong>' + escapeHtml(data.email) + '</strong>' : ''}
                    <br><br>
                    Questions? <a href="tel:825-994-6606" style="color:var(--blue)">825-994-6606</a>
                    &nbsp;Â·&nbsp;
                    <a href="#" onclick="document.getElementById('mainCard').innerHTML='';location.reload()" style="color:var(--blue)">Track this booking (${ref})</a>
                </p>
                <button class="btn-another" onclick="location.reload()">Book Another Service</button>
            </div>`;
    }

    // â”€â”€ FORM SUBMIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('bookingForm').addEventListener('submit', async e => {
        e.preventDefault();
        const fd = new FormData(e.target);
        const errs = validateForm(fd);
        if (errs.length) {
            showError('error-msg', errs.join(' Â· '));
            return;
        }
        document.getElementById('error-msg').style.display = 'none';

        const btn = document.getElementById('submitBtn');
        const txt = document.getElementById('btnText');
        btn.disabled = true;
        txt.innerHTML = '<span class="spinner"></span> Booking your appointmentâ€¦';

        const payload = {
            name:    fd.get('name').trim(),
            phone:   fd.get('phone').trim(),
            email:   fd.get('email')?.trim() || null,
            address: fd.get('address').trim(),
            service: selectedService,
            date:    fd.get('date'),
            time:    fd.get('time'),
            notes:   fd.get('notes')?.trim() || ''
        };

        try {
            const res    = await fetch('/api/booking/book', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            const result = await res.json();
            if (result.success) {
                showConfirmation(result.data, payload);
            } else {
                throw new Error(result.message || result.error || 'Booking failed â€” please try again.');
            }
        } catch (err) {
            showError('error-msg', err.message || 'Something went wrong. Please call 825-994-6606.');
            btn.disabled = false;
            txt.textContent = 'Book Now â€” Free Quote';
        }
    });

    // â”€â”€ PHONE AUTO-FORMAT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('phone').addEventListener('input', function() {
        let v = this.value.replace(/\D/g, '');
        if (v.length >= 6) v = v.slice(0,3) + '-' + v.slice(3,6) + '-' + v.slice(6,10);
        else if (v.length >= 3) v = v.slice(0,3) + '-' + v.slice(3);
        this.value = v;
    });

    // â”€â”€ DATE CONSTRAINTS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    (function() {
        const di  = document.getElementById('date');
        const now = new Date();
        const max = new Date(); max.setDate(max.getDate() + 90);
        di.min   = now.toISOString().split('T')[0];
        di.max   = max.toISOString().split('T')[0];
        // Default to tomorrow
        const tmr = new Date(now); tmr.setDate(tmr.getDate() + 1);
        di.value = tmr.toISOString().split('T')[0];
    })();

    // â”€â”€ PROGRESS UPDATE ON INPUT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('bookingForm').addEventListener('input', updateProgress);
    document.getElementById('bookingForm').addEventListener('change', updateProgress);

    // â”€â”€ TRACK: REF INPUT AUTO-FORMAT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    document.getElementById('refInput').addEventListener('input', function() {
        let v = this.value.toUpperCase().replace(/[^A-Z0-9]/g, '');
        if (v.startsWith('JOB')) {
            const d = v.slice(3).replace(/\D/g,'').slice(0,4);
            this.value = d.length ? 'JOB-' + d : 'JOB-';
        } else {
            this.value = v;
        }
    });
    document.getElementById('refInput').addEventListener('keydown', e => {
        if (e.key === 'Enter') lookupStatus();
    });

    // â”€â”€ STATUS LOOKUP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    async function lookupStatus() {
        const ref   = document.getElementById('refInput').value.trim().toUpperCase();
        const errEl = document.getElementById('trackErrorMsg');
        const resEl = document.getElementById('resultCard');
        const btn   = document.getElementById('lookupBtn');

        errEl.style.display = 'none';
        resEl.style.display = 'none';

        if (!/^JOB-\d{1,4}$/.test(ref)) {
            showError('trackErrorMsg', 'Please enter a valid reference like JOB-0001');
            return;
        }

        btn.disabled = true;
        btn.textContent = 'Looking upâ€¦';

        try {
            const res    = await fetch('/api/booking/status/' + encodeURIComponent(ref));
            const result = await res.json();
            if (!result.success) {
                showError('trackErrorMsg', result.error || 'Booking not found. Check the reference and try again.');
                return;
            }
            renderStatusResult(result.data);
        } catch (err) {
            showError('trackErrorMsg', 'Could not connect. Please try again or call 825-994-6606.');
        } finally {
            btn.disabled = false;
            btn.textContent = 'Check';
        }
    }

    function renderStatusResult(d) {
        const statusStyles = {
            'Scheduled':   { cls: 'st-scheduled',   hdr: 'background:#dbeafe;color:#1d4ed8' },
            'In Progress': { cls: 'st-in-progress',  hdr: 'background:#fef3c7;color:#d97706' },
            'Completed':   { cls: 'st-completed',    hdr: 'background:#d1fae5;color:#059669' },
            'Cancelled':   { cls: 'st-cancelled',    hdr: 'background:#f3f4f6;color:#6b7280' }
        };
        const st  = statusStyles[d.status] || { cls: 'st-scheduled', hdr: '' };
        const hdr = document.getElementById('resultHeader');
        hdr.style.cssText = st.hdr;
        hdr.textContent   = 'Booking ' + escapeHtml(d.reference);

        const dateStr = d.date
            ? new Date(d.date + 'T00:00:00').toLocaleDateString('en-US', { weekday:'long', year:'numeric', month:'long', day:'numeric' })
            : 'â€”';
        const timeStr = d.time
            ? new Date('2000-01-01T' + d.time + ':00').toLocaleTimeString('en-US', { hour:'numeric', minute:'2-digit', hour12:true })
            : 'â€”';

        document.getElementById('resultBody').innerHTML = `
            <div class="result-row"><span class="rl">Reference</span><span class="rv ref-val">${escapeHtml(d.reference)}</span></div>
            <div class="result-row"><span class="rl">Status</span><span class="badge-status ${st.cls}">${escapeHtml(d.status)}</span></div>
            <div class="result-row"><span class="rl">Service</span><span class="rv">${escapeHtml(d.service)}</span></div>
            <div class="result-row"><span class="rl">Date</span><span class="rv">${dateStr}</span></div>
            <div class="result-row"><span class="rl">Arrival Window</span><span class="rv">${timeStr}</span></div>
            <div class="result-row"><span class="rl">Assigned Cleaner</span><span class="rv">${escapeHtml(d.assignedStaff)}</span></div>`;

        document.getElementById('resultCard').style.display = 'block';
    }

    // â”€â”€ URL PARAMS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    (function handleUrlParams() {
        const params = new URLSearchParams(window.location.search);
        const ref    = params.get('ref');
        const svc    = params.get('service');
        const hash   = window.location.hash;

        // ?ref=JOB-XXXX â†’ open Track tab and auto-lookup
        if (ref) {
            switchTab('track');
            document.getElementById('refInput').value = ref.toUpperCase();
            lookupStatus();
            return;
        }

        // #track hash â†’ open Track tab
        if (hash === '#track') {
            switchTab('track');
            return;
        }

        // ?service=X â†’ preselect service once cards load
        if (svc) {
            const iv = setInterval(() => {
                const cards = document.querySelectorAll('.service-card[data-name]');
                if (!cards.length) return;
                clearInterval(iv);
                cards.forEach(c => { if (c.dataset.name === svc) selectService(c); });
            }, 100);
            setTimeout(() => clearInterval(iv), 5000);
        }
    })();

    // â”€â”€ INIT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    loadServices();
</script>
</body>
</html>
